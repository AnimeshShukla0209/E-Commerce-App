<div class="buyer-dashboard-wrapper">
  <!-- Top Navbar -->
  <nav class="dashboard-navbar">
    <span class="logo">
      <svg class="cart-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7 18C6.44772 18 6 18.4477 6 19C6 19.5523 6.44772 20 7 20C7.55228 20 8 19.5523 8 19C8 18.4477 7.55228 18 7 18Z" fill="white"/>
        <path d="M17 18C16.4477 18 16 18.4477 16 19C16 19.5523 16.4477 20 17 20C17.5523 20 18 19.5523 18 19C18 18.4477 17.5523 18 17 18Z" fill="white"/>
        <path d="M3 4H5L6.68 15.39C6.7716 16.0282 7.31213 16.5 7.96 16.5H19.5C20.0523 16.5 20.5 16.0523 20.5 15.5C20.5 14.9477 20.0523 14.5 19.5 14.5H8.42L8.28 13.5H19.5C19.8978 13.5 20.2794 13.342 20.5607 13.0607C20.842 12.7794 21 12.3978 21 12V6.5C21 5.94772 20.5523 5.5 20 5.5H6.21L5.27 2.5H3V4Z" fill="white"/>
      </svg>
      Local Ease
    </span>
    <div class="search-bar">
      <select [(ngModel)]="searchFilter">
        <option value="name">By Product Name</option>
        <option value="area">By Area</option>
      </select>
      <input type="text" [(ngModel)]="searchQuery" placeholder="Search by product or area" />
      <button (click)="searchProducts()">Search</button>
    </div>
    <div class="navbar-actions">
      <div class="user-greeting">
        Welcome, <strong>{{ userName }}</strong>
      </div>
      <div class="top-icons">
        <span class="material-icons icon" [class.active]="isDropdownOpen" (click)="toggleDropdown()">account_circle</span>
        <span class="material-icons icon" routerLink="/cart">shopping_cart</span>
        <span class="material-icons icon" routerLink="/wishlist">favorite</span>
      </div>
      <div class="dropdown-menu" *ngIf="isDropdownOpen">
        <a [routerLink]="['/profile']" [queryParams]="{ role: 'buyer' }">Profile</a>  
        <a (click)="goToOrders()">My Orders</a>
        <a (click)="logout()">Logout</a>
      </div>
    </div>
  </nav>

  <div class="dashboard-main">
    <aside class="sidebar">
      <ul>
        <li routerLink="/buyer-dashboard">Home</li>
        <li class="dropdown-wrapper">
          <div (click)="toggleCategoryDropdown()" class="dropdown-toggle">
            Categories
          </div>
          <ul *ngIf="isCategoryDropdownOpen" class="category-dropdown-list">
            <li *ngFor="let category of categories" (click)="goToCategoryProducts(category.name)">
              {{ category.name }}
            </li>
          </ul>
        </li>
        <li routerLink="/orders">My Orders</li>
        <li routerLink="/settings">Settings</li>
        <li (click)="logout()">Logout</li>
      </ul>
    </aside>

    <div class="dashboard-content">
      <h4 *ngIf="selectedCategory">Products in "{{ selectedCategory }}"</h4>
      <h4 *ngIf="!selectedCategory">Featured Products</h4>
      <div class="product-grid">
        <div class="product-card" *ngFor="let product of featuredProducts">
          <img 
            [src]="product.imageUrl" 
            alt="{{ product.name }}" 
            class="product-img"
            (error)="onImgError($event)"
          />
          <div class="product-details">
            <h3 class="product-title">{{ product.name }}</h3>
            <p class="product-price">â‚¹{{ product.price }}</p>
            <div class="product-actions">
              <button class="btn-cart" (click)="addToCart(product)">
                <span class="material-icons">shopping_cart</span> Add to Cart
              </button>
              <button class="btn-wishlist" (click)="addToWishlist(product)">
                <span class="material-icons">{{ product.isInWishlist ? 'favorite' : 'favorite_border' }}</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <router-outlet></router-outlet>
</div>